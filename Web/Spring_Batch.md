# Spring Batch

# Cron Expression

>   `Cron`이란 유닉스 계열의 운영체제에서 시간 기반으로 job scheduling을 하는 후면 프로세스의 명칭이다.

Cron표현식은 `org.quartz.Trigger`의 하위 클래스인 `CronTrigger`의 인스턴스를 구성하는데 사용된다.

유닉스나 리눅스 계열의 스케쥴링 작업에도 사용되지만 Java Spring 기반의 서버 스케쥴러르 개발할 때에도 종종 사용된다.



일반적으로 스케쥴의 개별 세부사항을 나타내는 6개 또는 7개의 하위 표현식으로 구성된 문자열이다. 각 단위는 초/분시 등으로 나누어지며 각각 **공백(" ")**으로 구분된다.

<img width="558" alt="image-20220515164034952" src="https://user-images.githubusercontent.com/58545240/168463322-7ce7c41d-f624-4f24-9cf3-d1d948fd3a24.png">



**예시를 함께 보자**

````java
CronExpression cronExpression = new CronExpression("0 30 13 ? 1-12 ?");
````

-   첫번째 단위는 **초(seconds)**이다.
-   두번째 단위는 **분(minutes)**이다.
-   세번째 단위는 **시(hours)**이다.
-   네번째 단위는 **일(day-of-month, DOM)**이다.
-   다섯번째 단위는 **월(month)**이다.
-   여섯번째 단위는 **요일(day-of-week)**이다.
    -   요일은 `0~6` 의 숫자로 쓸 수 도 있지만 `"MON", "SUN"`과 같이 요일의 약자로도 사용 가능하다.
-   일곱번째 단위는 **연도(year)**이다.



**추가로 알아야 할 표현식 개념에 대해 알아보자.**

-   **`와일드카드(*)`** : 매 번(every)을 의미한다
-   **`-`** : 각각의 단위는 범위나 목록으로 나타낼 수도 있다. 일(DOM)에 `1-15`라고 쓴다면 1일부터 15일까지를 뜻한다.
-   **`쉼표(,)`** : 일련의 값들을 나열할 때 사용된다.
    -   예를 들어, `1,3,5`로 쓴단다면 1분, 3분, 5분에 Job이 수행됨을 의미한다.
-   **`물음표(?)`** : 설정값 없음을 의미한다. 일(DOM)과 요일(DOW)에만 사용할 수 있다.
-   **`슬래쉬(/)`** : 초기치르 기준으로 일정한 값으로 증가되는 값을 표현할 때 사용된다.
    -   분(minutes)에 `10/15`라고 쓴다면 10분부터 시작해서 매 15분마다를 의미한다.
-   **`샾(#)`** : `k#N` 으로 사용되며, 이 달의 N번째 K요일을 의미한다.
    -   요일(DOW)에 `3#4`라고 쓴다면, 이달의 네번째 수요일을 의미한다.
-   **`"L"`** : 마지막(Last)를 의미한다. 일(DOM)과 요일(DOW)에만 사용할 수 있다.
    -   예를 들어 DOM 항목에 L이 사용된다면 단순하게 해당 월의 마지막 날을 의미한다. 조금 다른 방법으로도 사용되는데, 특정 값 뒤에 사용된다면 "이 달의 마지막 날"을 의미하게 된다.
    -   요일에 `6L`을 쓴다면 이달의 마지막 금요일을 의미한다.
-   **`"W"`** : 해당 날로부터 가장 가까운 평일(Weekday)을 의미한다.
    -   일(DOM)에 `10W`라고 쓴다면, 이달의 10번째 날로부터 가장 가까운 평일을 의미한다.
-   **`"C"`** : "calendar"의 약자로 트리거에 설정된 Quartz Calendar에 의해 해당 값이 결정된다.
    -   Quartcz Calendar는 트리거에 의한 실행을 일정 기간/일자에 대해 실행을 배제할 때 사용하게 된다.
    -   예를 들어 일(DOM)에 `5C`는 Calendar에 의해 허용되는 5번째 일자 또는 다음 5번째 일자를 나타내고, 
        요일(DOW)에 `1C`는 Calendar에 의해 허용되는 첫 번째 요일 또는 다음 일요일을 의미한다.
-   각각의 항목은 항목에 유효한 값만 들어올 수 있다. 예를들어 일은 1~31 사이 숫자만 허용되며 시간은 0~23 사이의 숫자만 허용된다.

<img width="592" alt="image-20220515165421919" src="https://user-images.githubusercontent.com/58545240/168463340-4111df51-2823-4c2c-a307-9efa29e7e84f.png">



>   *https://docs.oracle.com/cd/E12058_01/doc/doc.1014/e12030/cron_expressions.htm*