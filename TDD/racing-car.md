# racing-car

> 11st에서 주최하고 next-step에서 진행하는 **TDD/클린코드/리팩터링 with JAVA** 과정을 진행하고 미션을 수행하며 있었던 일을 회고한다.

# 01/20

## ㅠㅠ단위테스트가 뭐야?!

오늘은 java-racing-car 미션에 대한 1차 제출 날이고, 요구사항 중 단위테스트를 만들지 못한 채 PR을 날렸다. 단위테스트를 만드는 법에 대해서 익숙치 않았고 조교님께 문의를 구했다.



조교님 왈

*Test 커버리지를 100%로 맞춰야 한다는 사람과 사소한 테스트는 넘어가도 좋다는 사람이 존재한다. 100%로 맞춰야 한다는 말은, 정말 아주 작은 단위라도 단위테스트를 수행해야 하는 것이다.*

이 부분은 앞으로 개발하면서 계속 고민해봐야 할 문제인 것 같다.



아래와 같은 랜덤 함수를 가져오는 작고 소중한 클래스가 있다.

```java
import java.util.Random;

public class RandomManager {
  
    private static final int LIMIT = 10;

    public static int get() {
        return new Random().nextInt(LIMIT);
    }
}
```

이를 테스트 하기 위해서는 어떻게 해야하는 가?

먼저, 이는 실제로 랜덤으로 동작하는 것이기 때문에 테스트 작성 과정에서는 이 값을 제어할 수 있어야 한다.

두 가지 방법이 있다.

1. `get()` 함수를 **Overriding** 하여 구현하는것.
2. **interface**를 이용해서 테스트를 위한 구현체를 따로 만들어 사용하는 것.

1번의 방법은 테스트 코드 내에서 메소드의 시그니처를 변경하는 방법이다. 하지만 이미 나의 난수를 구하는 코드는 클래스로 따로 빼두었기 때문에 인터페이스를 활용한 방법을 추천해주셨다.



하지만 나는 한번에 이해가 가지 않았고 조교님은 두 개의 링크를 주시며 이해에 도움을 더해 주셨다.

> https://tecoble.techcourse.co.kr/post/2020-05-07-appropriate_method_for_test_by_parameter/
>
> https://tecoble.techcourse.co.kr/post/2020-04-28-test-without-method-change/



일단 이를 참고해서 단위테스트 케이스를 만들 생각이다.

그리고 RandomManager라는 이름보다는 RandomGenerator라는 이름이 더 직관적이라는 생각이 들었다^^.



## 싱글톤이에요? 정적팩토리메서드에요?

당시 모든 클래스의 생성자를 정적 팩토리 메소드로 구현하였는데, 이런 경우는 생성자를 private으로 두는 것이 좋을 것 같다는 말씀을 해주셨다.

그렇지 않으면 다른 사람들이 봤을 때 어느 것을 사용할 지 혼란을 주기 때문일 것이다.

그렇기 때문에 현장에서는 **생성자**와 **정적팩토리메서드**를 고민한다고 되는데, 그 기준을 잡기 어렵기 때문이라고 한다. 만약 정적팩토리메서드를 사용한다면 싸그리 모두 정적팩토리를 사용하는 것이 좋을 것이라고 한다.



그리고 `getInstance()` 라는 이름의 정적팩토리메서드를 만들었는데 이름 때문에 싱글톤으로 헷갈리셨다. 이 부분에 대해서도 좀 더 가독성있는 이름을 채택해야겠다고 생각했다.



## 페어와 함께하는 클린코드

단위테스트에서 호되게 깨지고 난 후 더 큰 깨달음을 얻기 위해 우아한테크세미나에서 박재성(포비)님이 강연하신 영상을 봤다.

기존에도 객체지향설계원칙에 대해 알고 있었지만 미션 중 

- indent는 2가 넘지 않게
- class의 인스턴스 변수는 최대 2개
- 함수와 클래스는 최대한 작게

등 과 같은 원칙을 지키기가 무척이나 어려웠던 것 같다.

특히, 시간이 촉박하기도 했지만 페어와 함께 프로그래밍하는 게 처음이고 어색하다보니 쉽게 지나쳤던 것을 반성한다.



세미나 영상을 보고 나서 다시 한번 동기부여를 얻을 수 있었고 내일부터 진행할 리팩토링 시간이 설렌다. 아주 작은 부분이라도 의식적인 연습을 하다보면 테스트코드도 잘 짜겠지!

